name: ipsec_skillet

label: IPSEC Config Skillet

description: Skillet for configuring IKE Gateway and IPSEC tunnel

type: panos

labels:

    collection: Unknown

variables: []

snippets:

-   name: tunnel-455683
    xpath: /config/devices/entry[@name="localhost.localdomain"]/network/interface
    element: |-
        <tunnel>
          <units>
            <entry name="tunnel.123">
              <comment>tunnel-from-1-2</comment>
            </entry>
          </units>
        </tunnel>
    cmd: set

-   name: gateway-4662
    xpath: /config/devices/entry[@name="localhost.localdomain"]/network/ike
    element: |-
        <gateway>
          <entry name="gw-to-2">
            <authentication>
              <pre-shared-key>
                <key>-AQ==IB8jxOT5t2N4quYAvwmOtD1c4fI=8dTKnz2HiAtg/m5OOnV66g8y/66Ejfl7I+J1WFwiiS3gMVfx+DZ/gyR2x+b3fs7E</key>
              </pre-shared-key>
            </authentication>
            <protocol>
              <ikev1>
                <dpd>
                  <enable>yes</enable>
                </dpd>
              </ikev1>
              <ikev2>
                <dpd>
                  <enable>yes</enable>
                </dpd>
              </ikev2>
            </protocol>
            <local-address>
              <ip>10.70.221.146/24</ip>
              <interface>ethernet1/1</interface>
            </local-address>
            <protocol-common>
              <nat-traversal>
                <enable>no</enable>
              </nat-traversal>
              <fragmentation>
                <enable>no</enable>
              </fragmentation>
            </protocol-common>
            <peer-address>
              <ip>10.70.221.192</ip>
            </peer-address>
            <comment>gateway to ngfw2</comment>
          </entry>
        </gateway>
    cmd: set

-   name: tunnel-466695
    xpath: /config/devices/entry[@name="localhost.localdomain"]/network
    element: |-
        <tunnel>
          <ipsec>
            <entry name="tunnel-to-2">
              <auto-key>
                <ike-gateway>
                  <entry name="gw-to-2"/>
                </ike-gateway>
              </auto-key>
              <tunnel-monitor>
                <enable>no</enable>
              </tunnel-monitor>
              <tunnel-interface>tunnel.123</tunnel-interface>
              <comment>tunnel to ngfw 2</comment>
              <disabled>no</disabled>
            </entry>
          </ipsec>
        </tunnel>
    cmd: set

-   name: interface-792448
    xpath: /config/devices/entry[@name="localhost.localdomain"]/network/virtual-router/entry[@name="default"]
    element: |-
        <interface>
          <member>ethernet1/1</member>
          <member>ethernet1/2</member>
          <member>tunnel.123</member>
        </interface>
    cmd: set

-   name: ecmp-550118
    xpath: /config/devices/entry[@name="localhost.localdomain"]/network/virtual-router/entry[@name="default"]
    element: |-
        <ecmp>
          <algorithm>
            <ip-modulo/>
          </algorithm>
        </ecmp>
    cmd: set

-   name: routing-table-631221
    xpath: /config/devices/entry[@name="localhost.localdomain"]/network/virtual-router/entry[@name="default"]
    element: |-
        <routing-table>
          <ip>
            <static-route>
              <entry name="route-to-2">
                <bfd>
                  <profile>None</profile>
                </bfd>
                <interface>tunnel.123</interface>
                <metric>10</metric>
                <destination>172.31.0.64/27</destination>
                <route-table>
                  <unicast/>
                </route-table>
              </entry>
              <entry name="fw dg">
                <nexthop>
                  <ip-address>10.70.221.192</ip-address>
                </nexthop>
                <bfd>
                  <profile>None</profile>
                </bfd>
                <interface>ethernet1/1</interface>
                <metric>10</metric>
                <destination>0.0.0.0/0</destination>
                <route-table>
                  <unicast/>
                </route-table>
              </entry>
            </static-route>
          </ip>
        </routing-table>
    cmd: set

